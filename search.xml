<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[多年前 写了个 XXtouch 自动注册 ICloud 账号的lua 留念一下 嘿嘿！]]></title>
    <url>%2F2018%2F03%2F18%2F%E5%A4%9A%E5%B9%B4%E5%89%8D-%E5%86%99%E4%BA%86%E4%B8%AA-XXtouch-%E8%87%AA%E5%8A%A8%E6%B3%A8%E5%86%8C-Icloud-%E8%B4%A6%E5%8F%B7%E7%9A%84lua-%E7%95%99%E5%BF%B5%E4%B8%80%E4%B8%8B%2F</url>
    <content type="text"><![CDATA[新手学习下lua 编写了个 基于 XXtouch 自动注册ICloud账号的脚本，不知道现在XXtouch 发展的怎么样了，当初刚入门IT第一个写的比较完整的小东西了。 Quick Start实现了 邮箱账号随机字符，可设定邮箱长度通用的三个问题设置自动开关飞行模式，lua小巧强大 附件下载地址 链接：https://pan.baidu.com/s/1gOVrLmmYmXpaTHIZGyO6AA 密码：eai8 代码getIcloud.lualocal confirm, selects = dialog() :config('test') :timeout(50) :add_label('填写一些配置') :add_label('iClou,这个文件夹及文件一定要有') :add_label('姓名是随机的') :add_label('如果邮箱账号是空的随机英文,也拼接数字') :add_input('邮箱账号', '') :add_label('邮箱账号是空的必填邮箱位数,数字') :add_input('邮箱位数', '') :add_input('邮箱密码', '') :add_label('问题答案三个必须不一样') :add_input('问题1', '') :add_input('问题2', '') :add_input('问题3', '') :add_label('飞行模式，几次后打开飞行模式进行切换IP,填写大于5的数字,不填就为关闭') :add_input('飞行模式', '') :add_label('数字每次加1,数字不填-默认‘0001’') :add_input('邮箱数字', '') :add_label('保存文件会加上当前的时间,精确到秒') :add_input('保存文件', 'user') :add_label('脚本长时间运行，请设置好停止方式') :show()thistime = os.date("%m".."_".."%d".."_".."%H".."_".."%M".."_".."%S")onext = image.load_file("/var/mobile/Media/1ferver/lua/scripts/iCloud/next.png");oeng = &#123;"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"&#125; --26writeFTPfile = ""UNUMBER = ""if selects["邮箱数字"] =="" then UNUMBER = "0001";else UNUMBER =selects["邮箱数字"];endofxmode = "0";ofxmodenumber = selects["飞行模式"];password = selects["邮箱密码"];oissue1 = selects["问题1"];oissue2 = selects["问题2"];oissue3 = selects["问题3"];luaPath = '/var/mobile/Media/1ferver/lua/scripts'inewicloud = image.load_file(luaPath.."/iCloud/icloud.png");isetbirth = image.load_file(luaPath.."/iCloud/birth.png");iwticname = image.load_file(luaPath.."/iCloud/writename.png");igetnewid = image.load_file(luaPath.."/iCloud/getid.png");iwtemail = image.load_file(luaPath.."/iCloud/writeemail.png");inextee = image.load_file(luaPath.."/iCloud/nextee.png"); iconsent = image.load_file(luaPath.."/iCloud/consent.png");iissue = image.load_file(luaPath.."/iCloud/issue.png");ianswer = image.load_file(luaPath.."/iCloud/answer.png");isettingic = image.load_file(luaPath.."/iCloud/settingicloud.png");ilogout = image.load_file(luaPath.."/iCloud/logout.png");ilogouttwo = image.load_file(luaPath.."/iCloud/logouttwo.png");ilogoutthree = image.load_file(luaPath.."/iCloud/logoutthree.png");ilogoutdel = image.load_file(luaPath.."/iCloud/logoutdel.png");function newfolder(path) return os.execute("mkdir "..path); endfunction newdir() local fileinfo = file.exists("/var/mobile/Media/1ferver/lua/scripts/iCloud/txt") if fileinfo =="directory" then local file = io.open("/var/mobile/Media/1ferver/lua/scripts/iCloud/txt/"..selects["保存文件"]..thistime..".txt","a") else newfolder("/var/mobile/Media/1ferver/lua/scripts/iCloud/txt"); local file = io.open("/var/mobile/Media/1ferver/lua/scripts/iCloud/txt/"..selects["保存文件"]..thistime..".txt","a") end writeFTPfile = "/var/mobile/Media/1ferver/lua/scripts/iCloud/txt/"..selects["保存文件"]..thistime..".txt";endnewdir()file.appends(writeFTPfile, "邮箱密码:"..selects["邮箱密码"].."\r\n".."问题1:"..selects["问题1"].."\r\n".."问题2:"..selects["问题2"].."\r\n".."问题3:"..selects["问题3"].."\r\n\r\n\r\n");function orandom(num) local ppotext = ""; for i= 0,num do local r = math.random(0, 26) ppotext = ppotext..oeng[r]; end return ppotext;endfunction findimgclick(images) local x, y = screen.find_image(images) if x ~= -1 and y ~= -1 then touch.tap(x+5, y+5) else sys.msleep(3000); local x, y = screen.find_image(images,90) if x ~= -1 and y ~= -1 then touch.tap(x+5, y+5) else sys.msleep(4000); local x, y = screen.find_image(images, 88) if x ~= -1 and y ~= -1 then touch.tap(x+5, y+5) else sys.msleep(4000); local x, y = screen.find_image(images, 85) if x ~= -1 and y ~= -1 then touch.tap(x+5, y+5) else sys.msleep(3000); local x, y = screen.find_image(images, 80) if x ~= -1 and y ~= -1 then touch.tap(x+5, y+5) else closeSetting() openSetting() end end end end endendfunction findimgone(oimages) local x, y = screen.find_image(oimages,95) if x ~= -1 and y ~= -1 then return true; else sys.msleep(4000); local x2, y2 = screen.find_image(oimages,95) if x2 ~= -1 and y2 ~= -1 then return true; else return false; end endendfunction openIcloud() findimgclick(inewicloud); sys.msleep(10000); local x,y = screen.find_image(isetbirth,90) if x~= -1 and y~=-1 then touch.on(170, 767):step_len(24):step_delay(0.1):move(170,1060):off() sys.msleep(3000); findimgclick(onext); writeName() else sys.msleep(4000); local x,y = screen.find_image(isetbirth,80) if x~= -1 and y~=-1 then touch.on(170, 767):step_len(24):step_delay(0.1):move(170,1060):off() sys.msleep(3000); findimgclick(onext); writeName() end endendfunction writeName() sys.msleep(4000); local findimg = findimgone(iwticname); local nameo = orandom(5); local namet = orandom(4); if findimg then sys.input_text(nameo, true) sys.msleep(1000); sys.input_text(namet, true) else if findimg then sys.msleep(2000); sys.input_text(nameo, true) sys.msleep(1000); sys.input_text(namet, true) else sys.msleep(2000); sys.input_text(nameo, true) sys.msleep(1000); sys.input_text(namet, true) end end local success = file.appends(writeFTPfile, "姓名："..nameo.."-"..namet.."\r\n") if success == false then sys.alert("姓名写入txt失败,请排查") end sys.msleep(5000); findimgclick(igetnewid) sys.msleep(3000); findimgclick(iwtemail) sys.msleep(3000); writeIcloud()endfunction writeoissue(ooissue) findimgclick(iissue) sys.msleep(2000); touch.tap(225, 400) sys.msleep(2000); findimgclick(ianswer) sys.msleep(2000); sys.input_text(ooissue, true)endfunction writeIcloud() local icemail = ""; local icemailnum = selects["邮箱位数"]; if selects["邮箱账号"] ~= "" then icemail = selects["邮箱账号"] else if icemailnum ~="" then icemail = orandom(icemailnum-1) else icemail = orandom(5) end end wicloud = icemail..UNUMBER; sys.input_text(wicloud, true) local success = file.appends(writeFTPfile, wicloud.."@icloud.com\r\n") if success == false then sys.alert("邮箱写入txt失败,请排查") end UNUMBER = UNUMBER+1; findimgclick(onext) sys.msleep(5000); findimgclick(inextee) sys.msleep(5000); sys.input_text(password, true) sys.msleep(1000); sys.input_text(password, true) sys.msleep(5000); writeoissue(oissue1) sys.msleep(1000); writeoissue(oissue2) sys.msleep(1000); writeoissue(oissue3) sys.msleep(5000); findimgclick(iconsent) sys.msleep(3000); findimgclick(iconsent) sys.msleep(10000); closeSetting() ofxmode = ofxmode+1;endfunction closeSetting() sys.msleep(25000); app.close("com.apple.Preferences") sys.msleep(5000) app.open_url("prefs:root=CASTLE"); sys.msleep(5000) getsticloud()endfunction getsticloud() local settingicloud = findimgone(isettingic) if settingicloud then sys.msleep(5000) touch.on(300, 1050):step_len(20):step_delay(0.1):move(330,400):off() sys.msleep(3000) findimgclick(ilogout) sys.msleep(2000); local x, y = screen.find_image(ilogouttwo, 85) if x ~= -1 and y ~= -1 then touch.tap(x+5, y+5) local x2, y2 = screen.find_image(ilogoutdel, 85) if x2 ~= -1 and y2 ~= -1 then touch.tap(x2+5, y2+5) local x3, y3 = screen.find_image(ilogoutthree, 85) if x3 ~= -1 and y3 ~= -1 then touch.tap(x3+5, y3+5) sys.input_text(password, true) sys.msleep(15000) closeSetting() openSetting() else sys.msleep(10000) closeSetting() sys.msleep(3000); openSetting() end else sys.msleep(15000) closeSetting() sys.msleep(3000); openSetting() end else local x, y = screen.find_image(ilogouttwo, 85) if x ~= -1 and y ~= -1 then touch.tap(x+5, y+5) local x2, y2 = screen.find_image(ilogoutdel, 85) if x2 ~= -1 and y2 ~= -1 then touch.tap(x2+5, y2+5) local x3, y3 = screen.find_image(ilogoutthree, 85) if x3 ~= -1 and y3 ~= -1 then touch.tap(x3+5, y3+5) sys.input_text(password, true) sys.msleep(15000) closeSetting() openSetting() else sys.msleep(15000) closeSetting() sys.msleep(3000); openSetting() end else sys.msleep(15000) closeSetting() sys.msleep(3000); openSetting() end else sys.msleep(15000) closeSetting() sys.msleep(3000); openSetting() end end else openSetting() endendfunction openSetting() if ofxmode == ofxmodenumber then device.turn_on_airplane() sys.msleep(3000); device.turn_off_airplane() ofxmode = "0"; sys.msleep(3000); end app.open_url("prefs:root=CASTLE"); sys.msleep(1000) local ppsettingicloud = findimgone(inewicloud); if ppsettingicloud == true then --sys.alert(ppsettingicloud,3); openIcloud() else --sys.alert("false",3); getsticloud() endendif (confirm) then print("你按下了提交") openSetting()else print("你没有按下提交,退出脚本") os.exit()end]]></content>
      <categories>
        <category>lua</category>
      </categories>
      <tags>
        <tag>lua</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python sqlalchemy 入门学习]]></title>
    <url>%2F2018%2F03%2F17%2Fpython-sqlalchemy-%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[新手入门Python[2.7.14] 因有一些需求使用模块 xlrd 读取表格，将数据插入SQLite Quick Start1.安装模块$ pip install xlrd$ pip install sqlalchemy 2.码农开始工作啦SQLite因为sqlite是基于文件的数据库。#!/usr/bin/python# -*- encoding: utf-8 -*-#导入模块import sqlalchemy,xlrdfrom sqlalchemy.ext.declarative import declarative_basefrom sqlalchemy import *from sqlalchemy.orm import * 连接数据库方法1# database URL 形式是 sqlite://&lt;nohostname&gt;/&lt;path&gt;engine = create_engine('sqlite:///test.db',echo=True) # [echo=True] 显示输出SQL语句到控制台(还有很多参数...)#如果没有test.db 就在当前目录下创建一个连接 方法2# 使用内存的两种方法# 1.engine = create_engine('sqlite://')# 2.engine = create_engine('sqlite:///:memory:') 定义模型class Test(Base): __tablename__=&apos;Test&apos; #表名 可以和类名不一致 id=Column(Integer,primary_key=True) name=Column(String(50)) age=Column(Integer) 创建表使用ORM，需要首先描述表，然后把类映射到表上。在SQLAclhemy中这两步通常在一起，使用叫做Declarative的系统，可以让我们创建一个包含描述我们需要创建表的类#需要先创建基类Base = declarative_base() 当声名ORM的类时，Declarative系统会使用python的元类，创建一个包含表信息的Table类（可以通过User.table_ 查看），然后通过Mapper把这个Table与ORM的类联系起来。所有ORM类的Table类都包含在一个MetaData类中，通过Base.metadata 可以查看MetaData类#MetaDatametadata = MetaData()#创建全部的表[定义多个模型全部创建] 如果创建过了 不会重复创建Base.metadata.create_all(engine)#创建session对象:SessionCls =sessionmaker(bind=engine)session = SessionCls()#先数据库插入一条数据ed_test=Test(name='Jones',age='23')session.add(ed_test)# 提交即保存到数据库:session.commit()#支持数据回滚#session.rollback()# 关闭session:session.close()#删除test表，id大于2的字段#session.query(Test).filter(name.id &gt; 2).delete()#查询test表下面name=liuyao的全部字段#ret = session.query(User).filter_by(name='Jones').all() #list 表格数据插入数据库表格数据#插入数据库代码#伸手党记得注释 上面那句 session.close() fileName = r"C:\Users\Administrator\Documents\test.xls"#写个类处理表格 将第一行作为 字典的键(将中文转换为英文)class excelToDict(): def __init__(self,fileName): self.data = [] #打开表格 book = xlrd.open_workbook(fileName) #取得第一张表格的名字 sheet_name = book.sheet_names()[0] #打开第一张表格 self.sheet = book.sheet_by_name(sheet_name) self.head = [n.encode("utf-8") for n in sheet.row_values(0)] #第一行的数据 self.nrows =sheet.nrows #总行数 self.setHeadData = &#123;"名字":"name","年龄":"age"&#125; self.setHeadName() def lineadd(self): index = 1 while (index &lt; self.nrows): rowData = &#123;&#125; anrows = self.sheet.row_values(index) for n,d in enumerate(self.head): rowData[d] = anrows[n] self.data.append(rowData) index += 1 return self.data def setHeadName(self): for n, d in enumerate(self.head): self.head[n] = self.setHeadData[d]dataAll = excelToDict(addfileName).lineadd()循环插入数据for data in dataAll: ed1_test = Test(**data) session.add(ed1_test)#提交数据并关闭连接session.commit()session.close() 贴个完整的代码#!/usr/bin/python# -*- encoding: utf-8 -*-#导入模块import sqlalchemy,xlrdfrom sqlalchemy.ext.declarative import declarative_basefrom sqlalchemy import *from sqlalchemy.orm import *engine = create_engine('sqlite:///test.db',echo=True)class Test(Base): __tablename__='Test' #表名 可以和类名不一致 id=Column(Integer,primary_key=True) name=Column(String(50)) age=Column(Integer) #需要先创建基类Base = declarative_base()#MetaDatametadata = MetaData()#创建session对象:SessionCls =sessionmaker(bind=engine)session = SessionCls()#先数据库插入一条数据ed_test=Test(name='Jones',age='23')session.add(ed_test)# 提交即保存到数据库:session.commit()fileName = r"C:\Users\Administrator\Documents\test.xls"#写个类处理表格 将第一行作为 字典的键(将中文转换为英文)class excelToDict(): def __init__(self,fileName): self.data = [] #打开表格 book = xlrd.open_workbook(fileName) #取得第一张表格的名字 sheet_name = book.sheet_names()[0] #打开第一张表格 self.sheet = book.sheet_by_name(sheet_name) self.head = [n.encode("utf-8") for n in sheet.row_values(0)] #第一行的数据 self.nrows =sheet.nrows #总行数 self.setHeadData = &#123;"名字":"name","年龄":"age"&#125; self.setHeadName() def lineadd(self): index = 1 while (index &lt; self.nrows): rowData = &#123;&#125; anrows = self.sheet.row_values(index) for n,d in enumerate(self.head): rowData[d] = anrows[n] self.data.append(rowData) index += 1 return self.data def setHeadName(self): for n, d in enumerate(self.head): self.head[n] = self.setHeadData[d]dataAll = excelToDict(addfileName).lineadd()循环插入数据for data in dataAll: ed1_test = Test(**data) session.add(ed1_test)#提交数据并关闭连接session.commit()session.close()]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
</search>
